<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

  <!-- Create claim_ticket_priority_log -->
  <changeSet id="1733229137734" author="matellio">
    <createTable tableName="claim_ticket_priority_log">
      <column name="id" type="BIGINT" autoIncrement="true">
        <constraints primaryKey="true" nullable="false" />
      </column>
      <column name="ticket_id" type="BIGINT" remarks="Ticket identifier for referencing the claim ticket id">
        <constraints nullable="false" />
      </column>
      <column name="priority" type="int" remarks="Priority level of the ticket (e.g., high, medium, low)">
        <constraints nullable="false" />
      </column>
      <column name="created_at" type="TIMESTAMP">
        <constraints nullable="false" />
      </column>
      <column name="created_by" type="BIGINT">
        <constraints nullable="false" />
      </column>
    </createTable>
    <!-- Foreign Key constraint for created_by linking to the jhi_user table -->
    <addForeignKeyConstraint baseColumnNames="created_by"
                             baseTableName="claim_ticket_priority_log"
                             constraintName="fk_claim_ticket_priority_log_created_by"
                             referencedColumnNames="id"
                             referencedTableName="jhi_user"/>
    <!-- Foreign Key constraint for ticket_id linking to the claim_ticket table -->
    <addForeignKeyConstraint baseColumnNames="ticket_id"
                             baseTableName="claim_ticket_priority_log"
                             constraintName="fk_claim_ticket_priority_log_ticket_id"
                             referencedColumnNames="id"
                             referencedTableName="claim_ticket"/>
  </changeSet>

  <!-- Create claim_ticket_status_log -->
  <changeSet id="1733229332942" author="matellio">
    <createTable tableName="claim_ticket_status_log">
      <column name="id" type="BIGINT" autoIncrement="true">
        <constraints primaryKey="true" nullable="false" />
      </column>
      <column name="ticket_id" type="BIGINT" remarks="Ticket identifier for referencing the claim ticket id">
        <constraints nullable="false" />
      </column>
      <!-- Status of the claim (Enum stored as INT) -->
      <column name="status" type="int"
              remarks="Current status of the claim ticket (e.g., NEW, ASSIGNED, IN_PROGRESS, etc.)">
        <constraints nullable="false"/>
      </column>
      <!-- Sub-status of the claim, based on REJECTED and CLOSED statuses (Enum stored as INT) -->
      <column name="sub_status" type="int" remarks="Sub-status of the claim ticket (e.g., REJECTED, CLOSED, etc.)">
        <constraints nullable="true"/>
      </column>
      <column name="created_at" type="TIMESTAMP">
        <constraints nullable="false" />
      </column>
      <column name="created_by" type="BIGINT">
        <constraints nullable="false" />
      </column>
    </createTable>
    <!-- Foreign Key constraint for created_by linking to the jhi_user table -->
    <addForeignKeyConstraint baseColumnNames="created_by"
                             baseTableName="claim_ticket_status_log"
                             constraintName="fk_claim_ticket_status_log_created_by"
                             referencedColumnNames="id"
                             referencedTableName="jhi_user"/>
    <!-- Foreign Key constraint for ticket_id linking to the claim_ticket table -->
    <addForeignKeyConstraint baseColumnNames="ticket_id"
                             baseTableName="claim_ticket_status_log"
                             constraintName="fk_claim_ticket_status_log_ticket_id"
                             referencedColumnNames="id"
                             referencedTableName="claim_ticket"/>
  </changeSet>

  <!-- Create claim_ticket_assign_log -->
  <changeSet id="173322943346" author="matellio">
    <createTable tableName="claim_ticket_assign_log">
      <column name="id" type="BIGINT" autoIncrement="true">
        <constraints primaryKey="true" nullable="false" />
      </column>
      <column name="ticket_id" type="BIGINT" remarks="Ticket identifier for referencing the claim ticket id">
        <constraints nullable="false" />
      </column>
      <column name="user_id" type="BIGINT" remarks="Financial Institute (FI) agent or SEPS agent responsible for handling the ticket">
        <constraints nullable="false" />
      </column>
      <column name="user_type" type="int" remarks="ticket assigned to FI or SEPS agent">
        <constraints nullable="false" />
      </column>
      <column name="created_at" type="TIMESTAMP">
        <constraints nullable="false" />
      </column>
      <column name="created_by" type="BIGINT">
        <constraints nullable="false" />
      </column>
    </createTable>
    <!-- Foreign Key constraint for created_by linking to the jhi_user table -->
    <addForeignKeyConstraint baseColumnNames="created_by"
                             baseTableName="claim_ticket_assign_log"
                             constraintName="fk_claim_ticket_assign_log_created_by"
                             referencedColumnNames="id"
                             referencedTableName="jhi_user"/>
    <!-- Foreign Key constraint for user_id linking to the jhi_user table -->
    <addForeignKeyConstraint baseColumnNames="user_id"
                             baseTableName="claim_ticket_assign_log"
                             constraintName="fk_claim_ticket_assign_log_user_id"
                             referencedColumnNames="id"
                             referencedTableName="jhi_user"/>
    <!-- Foreign Key constraint for ticket_id linking to the claim_ticket table -->
    <addForeignKeyConstraint baseColumnNames="ticket_id"
                             baseTableName="claim_ticket_assign_log"
                             constraintName="fk_claim_ticket_assign_log_ticket_id"
                             referencedColumnNames="id"
                             referencedTableName="claim_ticket"/>
  </changeSet>

  <!-- Create claim_ticket_instance_log -->
  <changeSet id="1733229570748" author="matellio">
    <createTable tableName="claim_ticket_instance_log">
      <column name="id" type="BIGINT" autoIncrement="true">
        <constraints primaryKey="true" nullable="false" />
      </column>
      <column name="ticket_id" type="BIGINT" remarks="Ticket identifier for referencing the claim ticket id">
        <constraints nullable="false" />
      </column>
      <column name="instance_type" type="int" remarks="Instance type of ticket (e.g., first,second,claim etc)">
        <constraints nullable="false" />
      </column>
      <column name="created_at" type="TIMESTAMP">
        <constraints nullable="false" />
      </column>
      <column name="created_by" type="BIGINT">
        <constraints nullable="false" />
      </column>
    </createTable>
    <!-- Foreign Key constraint for created_by linking to the jhi_user table -->
    <addForeignKeyConstraint baseColumnNames="created_by"
                             baseTableName="claim_ticket_instance_log"
                             constraintName="fk_claim_ticket_instance_log_created_by"
                             referencedColumnNames="id"
                             referencedTableName="jhi_user"/>
    <!-- Foreign Key constraint for ticket_id linking to the claim_ticket table -->
    <addForeignKeyConstraint baseColumnNames="ticket_id"
                             baseTableName="claim_ticket_instance_log"
                             constraintName="fk_claim_ticket_instance_log_ticket_id"
                             referencedColumnNames="id"
                             referencedTableName="claim_ticket"/>
  </changeSet>

  <changeSet id="1733229699006" author="matellio">
    <addColumn tableName="claim_ticket">
      <column name="seps_agent_id" type="bigint"
              remarks="SEPS agent responsible for handling the ticket">
        <constraints nullable="true"/>
      </column>
    </addColumn>
    <!-- Foreign Key constraint for seps_agent_id linking to the jhi_user table -->
    <addForeignKeyConstraint baseColumnNames="seps_agent_id"
                             baseTableName="claim_ticket"
                             constraintName="fk_claim_ticket_fi_seps_agent_id"
                             referencedColumnNames="id"
                             referencedTableName="jhi_user"/>

  </changeSet>
</databaseChangeLog>
